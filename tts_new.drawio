<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36" version="28.1.0">
  <diagram name="Page-1" id="gTxwGaRwsPeCV-CFNJgF">
    <mxGraphModel dx="3894" dy="2295" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="nW7XktpqRqi-2gm5SUBW-39" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-1" target="nW7XktpqRqi-2gm5SUBW-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-1" value="RVQ.copy()&lt;br&gt;updated during training&amp;nbsp;" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="745" y="335" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-2" value="h @ codebook.T = logits" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="725" y="425" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-3" value="&lt;b&gt;Weight tying&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="745" y="305" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-4" target="nW7XktpqRqi-2gm5SUBW-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="nW7XktpqRqi-2gm5SUBW-4" target="nW7XktpqRqi-2gm5SUBW-44" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="613" y="433" as="sourcePoint" />
            <mxPoint x="668" y="698" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-50" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;OR&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="nW7XktpqRqi-2gm5SUBW-49" vertex="1" connectable="0">
          <mxGeometry x="0.1813" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-61" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;h&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="nW7XktpqRqi-2gm5SUBW-49" vertex="1" connectable="0">
          <mxGeometry x="-0.4975" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-57" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="1" source="nW7XktpqRqi-2gm5SUBW-4" target="nW7XktpqRqi-2gm5SUBW-52" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="665" y="105" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-58" value="&lt;font style=&quot;font-size: 18px;&quot;&gt;OR&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="nW7XktpqRqi-2gm5SUBW-57" vertex="1" connectable="0">
          <mxGeometry x="-0.4251" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-59" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;h&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="nW7XktpqRqi-2gm5SUBW-57" vertex="1" connectable="0">
          <mxGeometry x="-0.7234" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-4" value="Transformer&lt;br&gt;Decoder" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="615" y="335" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-6" target="nW7XktpqRqi-2gm5SUBW-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-6" value="Input text&amp;nbsp;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-780" y="210" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-7" target="nW7XktpqRqi-2gm5SUBW-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-7" value="Tokenizer&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;&amp;nbsp;&lt;/span&gt;&lt;div&gt;G2P&lt;/div&gt;&lt;div&gt;Phoemizer&lt;/div&gt;" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-670" y="195" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-9" target="nW7XktpqRqi-2gm5SUBW-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-9" value="Audio RVQ vectors" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-495" y="440" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-48" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-10" target="wmjjGflO25J7VR-AUJGW-46" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-10" value="Projection layer" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-335" y="425" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-12" value="&lt;i&gt;To make to same dim as text embedding&lt;/i&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-310" y="505" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-14" value="&lt;i&gt;Vector is used instead of ID, cause it already represent the vector respresation of audio but from different distribution than text&lt;/i&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-555" y="497.5" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nW7XktpqRqi-2gm5SUBW-15" target="wmjjGflO25J7VR-AUJGW-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-15" value="Learned Embedding matrix" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-470" y="195" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-17" value="&lt;i&gt;This saves parameters&amp;nbsp;&lt;/i&gt;&lt;div&gt;&lt;i&gt;keeps output close to real audio token space&lt;/i&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="705" y="465" width="170" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-18" target="nW7XktpqRqi-2gm5SUBW-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-18" value="Audio ID from RVQ" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-395" y="700" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-19" target="nW7XktpqRqi-2gm5SUBW-27" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-19" value="&amp;nbsp;Learned Audio embedding matrix" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-285" y="685" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-28" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="nW7XktpqRqi-2gm5SUBW-27" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-75" y="800" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-26" value="Position embedding =&amp;nbsp; capture temporal info accros time" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-225" y="1110" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-27" value="+" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-115" y="670" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-33" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;h&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="689" y="352" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-35" value="&lt;b&gt;Note &lt;/b&gt;:&lt;div&gt;&lt;i&gt;&amp;nbsp;h @ codebook.t only make sense if h lies in the same semantic space as the RVQ codebook vectors , But there is a possibility that it RVQ.copy might shift from original VQ during training due to weight update&lt;/i&gt;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="685" y="535" width="240" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-36" target="nW7XktpqRqi-2gm5SUBW-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-36" value="Optional : with Reduced Learning rate" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="714" y="275" width="146" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-41" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-37" target="nW7XktpqRqi-2gm5SUBW-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-37" value="Logits" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="860" y="360" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-40" value="Cross entropy loss" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="945" y="360" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-43" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="nW7XktpqRqi-2gm5SUBW-9" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-605" y="455" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-50" value="RoPE" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="nW7XktpqRqi-2gm5SUBW-43" vertex="1" connectable="0">
          <mxGeometry x="-0.2962" y="3" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-44" value="Use normal Learned embedding layer at the output than RVQ.copy" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="750" y="645" width="90" height="90" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-64" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="nW7XktpqRqi-2gm5SUBW-52" target="nW7XktpqRqi-2gm5SUBW-66" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="870" y="140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-52" value="Linear Projection Matrix&lt;div&gt;&lt;br/&gt;&lt;/div&gt;" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="755" y="95" width="90" height="90" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-53" value="logits = (h @ W_proj) @ codebook.T" style="text;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="995" y="160" width="230" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-62" value="Freeze the original RVQ codebook :&amp;nbsp;&lt;div&gt;Learn a projection matrix W to bring the model outputs into RVQ space&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="605" y="55" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-65" value="&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord mathcal&quot;&gt;L&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mrel&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;strut&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt;CrossEntropy&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt;softmax&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mopen&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mord mathbf&quot;&gt;h&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathbf&quot;&gt;W_&lt;/span&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot;&gt;&lt;span class=&quot;pstrut&quot;&gt;&lt;/span&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord text mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;proj&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;mord mathbf&quot;&gt;CT&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;mpunct&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mspace&quot;&gt;&lt;/span&gt;&lt;span class=&quot;mord text&quot;&gt;&lt;span class=&quot;mord&quot;&gt;token_id&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;mclose&quot;&gt;)&lt;/span&gt;&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="995" y="125" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-67" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="nW7XktpqRqi-2gm5SUBW-66" target="nW7XktpqRqi-2gm5SUBW-65" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-66" value="RVQ.copy() freezed" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="895" y="100" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-68" value="&lt;span class=&quot;katex&quot;&gt;&lt;span class=&quot;katex-mathml&quot;&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mtext&gt;proj&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;∈&lt;/mo&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mtext&gt;model&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;×&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mtext&gt;codebook&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;\mathbf{W}_{\text{proj}} \in \mathbb{R}^{d_{\text{model}} \times d_{\text{codebook}}}&lt;/math&gt;&lt;/span&gt;&lt;span aria-hidden=&quot;true&quot; class=&quot;katex-html&quot;&gt;&lt;span class=&quot;base&quot;&gt;&lt;span class=&quot;mord&quot;&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot;&gt;&lt;span class=&quot;sizing reset-size6 size3 mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;mord mtight&quot;&gt;&lt;span class=&quot;msupsub&quot;&gt;&lt;span class=&quot;vlist-t vlist-t2&quot;&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist-s&quot;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;vlist-r&quot;&gt;&lt;span class=&quot;vlist&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="725" y="185" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-73" value="&lt;font style=&quot;font-size: 23px;&quot;&gt;&lt;u&gt;&lt;b style=&quot;&quot;&gt;&lt;font style=&quot;&quot;&gt;Tokenizer&lt;/font&gt;&lt;/b&gt; :&amp;nbsp;&lt;/u&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-570" y="1112.5" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-75" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;tokenizer choice is a &lt;strong style=&quot;&quot; data-end=&quot;74&quot; data-start=&quot;39&quot;&gt;critical architectural decision&lt;/strong&gt;, especially when bridging &lt;strong style=&quot;&quot; data-end=&quot;119&quot; data-start=&quot;101&quot;&gt;text and audio&lt;/strong&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-550" y="1160.5" width="730" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-76" value="&lt;font style=&quot;font-size: 24px;&quot;&gt;&lt;b&gt;Objective :&amp;nbsp;&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-850" y="-160" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-77" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;Learn a shared text-audio latent representation&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;&lt;font style=&quot;&quot;&gt;possible by&amp;nbsp;&lt;/font&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Possibly using&lt;b&gt; &lt;/b&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot; data-end=&quot;532&quot; data-start=&quot;516&quot;&gt;weight tying&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;, projection, and cross-attention&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-895" y="-120" width="550" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-78" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;&lt;b style=&quot;&quot;&gt;Choice 1 : Phoneme based Tokenization (G2P)&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-555" y="1190.5" width="380" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-79" value="&lt;h3 data-end=&quot;735&quot; data-start=&quot;721&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;✅ &lt;strong style=&quot;&quot; data-end=&quot;735&quot; data-start=&quot;727&quot;&gt;Pros&lt;/strong&gt;&lt;/font&gt;&lt;/h3&gt;&lt;ol data-end=&quot;1415&quot; data-start=&quot;736&quot;&gt;&lt;li data-end=&quot;985&quot; data-start=&quot;736&quot;&gt;&lt;p data-end=&quot;767&quot; data-start=&quot;739&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;strong data-end=&quot;765&quot; data-start=&quot;739&quot;&gt;1:1 Mapping with Audio&lt;/strong&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Each phoneme maps closely to &lt;/span&gt;&lt;strong style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot; data-end=&quot;832&quot; data-start=&quot;802&quot;&gt;specific acoustic features&lt;/strong&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt; (e.g., /a/, /k/, /s/)&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;This gives the model a &lt;/span&gt;&lt;strong style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot; data-end=&quot;902&quot; data-start=&quot;883&quot;&gt;clean alignment&lt;/strong&gt;&lt;/font&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-size: 15px;&quot;&gt;&amp;nbsp; between input and output&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-size: 15px;&quot;&gt;Easy to learn &lt;/span&gt;&lt;strong style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-size: 15px;&quot; data-end=&quot;969&quot; data-start=&quot;947&quot;&gt;temporal alignment&lt;/strong&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-size: 15px;&quot;&gt; with RVQ tokens&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;1146&quot; data-start=&quot;987&quot;&gt;&lt;p data-end=&quot;1025&quot; data-start=&quot;990&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;strong data-end=&quot;1023&quot; data-start=&quot;990&quot;&gt;Low Vocabulary Size (~60–100)&lt;/strong&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Smaller embedding space → easier optimization&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Embedding vectors generalize better (shared sounds across words)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;1284&quot; data-start=&quot;1148&quot;&gt;&lt;p data-end=&quot;1199&quot; data-start=&quot;1151&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;strong data-end=&quot;1197&quot; data-start=&quot;1151&quot;&gt;Better for Prosody &amp;amp; Pronunciation Control&lt;/strong&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Can handle homographs and pronunciation variants (e.g., &quot;lead&quot; /lɛd/ vs /liːd/)&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;1415&quot; data-start=&quot;1286&quot;&gt;&lt;p data-end=&quot;1320&quot; data-start=&quot;1289&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;strong style=&quot;&quot; data-end=&quot;1318&quot; data-start=&quot;1289&quot;&gt;Proven in SOTA TTS Models&lt;/strong&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;All of: &lt;/span&gt;&lt;strong style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot; data-end=&quot;1388&quot; data-start=&quot;1334&quot;&gt;VALL-E, VALL-E X, SPEAR-TTS, FastSpeech, Tacotron2&lt;/strong&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt; use phonemes or characters&lt;/span&gt;&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-555" y="1200" width="1530" height="180" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-80" value="&lt;h3 data-end=&quot;1436&quot; data-start=&quot;1422&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;❌ &lt;strong style=&quot;&quot; data-end=&quot;1436&quot; data-start=&quot;1428&quot;&gt;Cons&lt;/strong&gt;&lt;/font&gt;&lt;/h3&gt;&lt;ol data-end=&quot;1761&quot; data-start=&quot;1437&quot;&gt;&lt;li data-end=&quot;1563&quot; data-start=&quot;1437&quot;&gt;&lt;p data-end=&quot;1467&quot; data-start=&quot;1440&quot;&gt;&lt;strong data-end=&quot;1467&quot; data-start=&quot;1440&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Needs G2P Preprocessing&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;1563&quot; data-start=&quot;1471&quot;&gt;&lt;li data-end=&quot;1510&quot; data-start=&quot;1471&quot;&gt;&lt;p data-end=&quot;1510&quot; data-start=&quot;1473&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;You need tools like CMUdict or espeak&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;1563&quot; data-start=&quot;1514&quot;&gt;&lt;p data-end=&quot;1563&quot; data-start=&quot;1516&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;G2P coverage for non-English languages may vary&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li data-end=&quot;1761&quot; data-start=&quot;1565&quot;&gt;&lt;p data-end=&quot;1612&quot; data-start=&quot;1568&quot;&gt;&lt;strong data-end=&quot;1612&quot; data-start=&quot;1568&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Cannot capture semantic meaning directly&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;1761&quot; data-start=&quot;1616&quot;&gt;&lt;li data-end=&quot;1687&quot; data-start=&quot;1616&quot;&gt;&lt;p data-end=&quot;1687&quot; data-start=&quot;1618&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Phonemes don’t encode word-level meaning — just &lt;strong data-end=&quot;1680&quot; data-start=&quot;1666&quot;&gt;how to say&lt;/strong&gt; things&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;1761&quot; data-start=&quot;1691&quot;&gt;&lt;p data-end=&quot;1761&quot; data-start=&quot;1693&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;You may need semantic embedding (optional) for content-based control&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-550" y="1366.5" width="580" height="240" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-81" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;Option 2: &lt;strong style=&quot;&quot; data-end=&quot;1815&quot; data-start=&quot;1784&quot;&gt;BPE Tokenization (like GPT)&lt;/strong&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-540" y="1601.5" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-82" value="&lt;h3 data-end=&quot;1831&quot; data-start=&quot;1817&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;✅ &lt;strong style=&quot;&quot; data-end=&quot;1831&quot; data-start=&quot;1823&quot;&gt;Pros&lt;/strong&gt;&lt;/font&gt;&lt;/h3&gt;&lt;ol data-end=&quot;2084&quot; data-start=&quot;1832&quot;&gt;&lt;li data-end=&quot;2012&quot; data-start=&quot;1832&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;p data-end=&quot;1863&quot; data-start=&quot;1835&quot;&gt;&lt;strong data-end=&quot;1863&quot; data-start=&quot;1835&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Captures Semantic Chunks&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;2012&quot; data-start=&quot;1867&quot;&gt;&lt;li data-end=&quot;1924&quot; data-start=&quot;1867&quot;&gt;&lt;p data-end=&quot;1924&quot; data-start=&quot;1869&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Can encode subwords like &quot;happi&quot;, &quot;ness&quot;, &quot;play&quot;, &quot;ing&quot;&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-end=&quot;2012&quot; data-start=&quot;1928&quot;&gt;&lt;p data-end=&quot;2012&quot; data-start=&quot;1930&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Good for semantic similarity in text-only tasks (e.g., translation, summarization)&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li data-end=&quot;2084&quot; data-start=&quot;2014&quot;&gt;&lt;p data-end=&quot;2037&quot; data-start=&quot;2017&quot;&gt;&lt;strong data-end=&quot;2037&quot; data-start=&quot;2017&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Widely supported&lt;/font&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ul data-end=&quot;2084&quot; data-start=&quot;2041&quot;&gt;&lt;li data-end=&quot;2084&quot; data-start=&quot;2041&quot;&gt;&lt;p data-end=&quot;2084&quot; data-start=&quot;2043&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Used in GPT-2, T5, BERT — easy to plug in&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ol&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-530" y="1622.5" width="630" height="240" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-83" value="&lt;h3 data-start=&quot;2091&quot; data-end=&quot;2129&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;❌ &lt;strong style=&quot;&quot; data-start=&quot;2097&quot; data-end=&quot;2129&quot;&gt;Cons&amp;nbsp;&lt;/strong&gt;&lt;/font&gt;&lt;/h3&gt;&lt;div class=&quot;_tableContainer_1rjym_1&quot;&gt;&lt;div tabindex=&quot;-1&quot; class=&quot;_tableWrapper_1rjym_13 group flex w-fit flex-col-reverse&quot;&gt;&lt;table data-start=&quot;2131&quot; data-end=&quot;2754&quot; class=&quot;w-fit min-w-(--thread-content-width)&quot;&gt;&lt;thead data-start=&quot;2131&quot; data-end=&quot;2171&quot;&gt;&lt;tr data-start=&quot;2131&quot; data-end=&quot;2171&quot;&gt;&lt;th data-start=&quot;2131&quot; data-end=&quot;2141&quot; data-col-size=&quot;sm&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;font style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 52, 19));&quot;&gt;Problem&lt;/font&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;&lt;/font&gt;&lt;/th&gt;&lt;th data-start=&quot;2141&quot; data-end=&quot;2171&quot; data-col-size=&quot;md&quot;&gt;&lt;font style=&quot;font-size: 15px; color: light-dark(rgb(0, 0, 0), rgb(255, 100, 26));&quot;&gt;Why it hurts text-to-audio&lt;/font&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody data-start=&quot;2213&quot; data-end=&quot;2754&quot;&gt;&lt;tr data-start=&quot;2213&quot; data-end=&quot;2300&quot;&gt;&lt;td data-start=&quot;2213&quot; data-end=&quot;2245&quot; data-col-size=&quot;sm&quot;&gt;&lt;strong data-start=&quot;2215&quot; data-end=&quot;2244&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;No 1:1 mapping with sound&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td data-start=&quot;2245&quot; data-end=&quot;2300&quot; data-col-size=&quot;md&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;BPE tokens don’t align to actual &lt;strong data-start=&quot;2280&quot; data-end=&quot;2298&quot;&gt;pronunciations&lt;br&gt;&lt;br&gt;&lt;/strong&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr data-start=&quot;2301&quot; data-end=&quot;2379&quot;&gt;&lt;td data-start=&quot;2301&quot; data-end=&quot;2325&quot; data-col-size=&quot;sm&quot;&gt;&lt;strong data-start=&quot;2303&quot; data-end=&quot;2324&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Huge vocab (~50K)&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td data-start=&quot;2325&quot; data-end=&quot;2379&quot; data-col-size=&quot;md&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Embedding matrix is huge, hard to train for speech&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr data-start=&quot;2380&quot; data-end=&quot;2460&quot;&gt;&lt;td data-start=&quot;2380&quot; data-end=&quot;2407&quot; data-col-size=&quot;sm&quot;&gt;&lt;strong data-start=&quot;2382&quot; data-end=&quot;2406&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Unpredictable splits&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td data-start=&quot;2407&quot; data-end=&quot;2460&quot; data-col-size=&quot;md&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Same word in different context → different tokens&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr data-start=&quot;2461&quot; data-end=&quot;2537&quot;&gt;&lt;td data-start=&quot;2461&quot; data-end=&quot;2487&quot; data-col-size=&quot;sm&quot;&gt;&lt;strong data-start=&quot;2463&quot; data-end=&quot;2486&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;No timing alignment&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td data-start=&quot;2487&quot; data-end=&quot;2537&quot; data-col-size=&quot;md&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Can&#39;t be matched cleanly with RVQ audio tokens&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr data-start=&quot;2538&quot; data-end=&quot;2662&quot;&gt;&lt;td data-start=&quot;2538&quot; data-end=&quot;2561&quot; data-col-size=&quot;sm&quot;&gt;&lt;strong data-start=&quot;2540&quot; data-end=&quot;2560&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Harder attention&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td data-start=&quot;2561&quot; data-end=&quot;2662&quot; data-col-size=&quot;md&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Attention between audio tokens and BPE is unstable — phoneme tokens have more &lt;strong data-start=&quot;2641&quot; data-end=&quot;2660&quot;&gt;clear structure&lt;br&gt;&lt;br&gt;&lt;/strong&gt;&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr data-start=&quot;2663&quot; data-end=&quot;2754&quot;&gt;&lt;td data-start=&quot;2663&quot; data-end=&quot;2689&quot; data-col-size=&quot;sm&quot;&gt;&lt;strong data-start=&quot;2665&quot; data-end=&quot;2688&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Poor generalization&lt;/font&gt;&lt;/strong&gt;&lt;/td&gt;&lt;td data-start=&quot;2689&quot; data-end=&quot;2754&quot; data-col-size=&quot;md&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;New words = unpredictable BPE split = broken audio generation&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-530" y="1832.5" width="750" height="320" as="geometry" />
        </mxCell>
        <UserObject label="&lt;p data-start=&quot;3221&quot; data-end=&quot;3245&quot;&gt;&lt;font style=&quot;font-size: 15px; color: light-dark(rgb(0, 0, 0), rgb(255, 178, 136));&quot;&gt;Imagine these two words:&lt;/font&gt;&lt;/p&gt;&lt;ul data-start=&quot;3247&quot; data-end=&quot;3302&quot;&gt;&lt;li data-start=&quot;3247&quot; data-end=&quot;3276&quot;&gt;&lt;p data-start=&quot;3249&quot; data-end=&quot;3276&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;“read” (present) = /r iː d/&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-start=&quot;3277&quot; data-end=&quot;3302&quot;&gt;&lt;p data-start=&quot;3279&quot; data-end=&quot;3302&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;“read” (past) = /r ɛ d/&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-start=&quot;3304&quot; data-end=&quot;3349&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;BPE might tokenize both as the same subwords:&lt;/font&gt;&lt;/p&gt;&lt;pre class=&quot;overflow-visible!&quot; data-start=&quot;3350&quot; data-end=&quot;3370&quot;&gt;&lt;div class=&quot;contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary&quot;&gt;&lt;div class=&quot;overflow-y-auto p-4&quot; dir=&quot;ltr&quot;&gt;&lt;code class=&quot;whitespace-pre!&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;span&gt;&lt;span class=&quot;hljs-selector-attr&quot;&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;re&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;ad&quot;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;]&lt;br&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/code&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;p data-start=&quot;3371&quot; data-end=&quot;3413&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;→ &lt;strong data-start=&quot;3373&quot; data-end=&quot;3413&quot;&gt;Same embedding, but different sounds&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;&lt;p data-start=&quot;3415&quot; data-end=&quot;3444&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;Phonemes would separate them:&lt;/font&gt;&lt;/p&gt;&lt;pre class=&quot;overflow-visible!&quot; data-start=&quot;3445&quot; data-end=&quot;3490&quot;&gt;&lt;div class=&quot;contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary&quot;&gt;&lt;div class=&quot;sticky top-9&quot;&gt;&lt;div class=&quot;absolute end-0 bottom-0 flex h-9 items-center pe-2&quot;&gt;&lt;div class=&quot;bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;&lt;span class=&quot;hljs-selector-attr&quot;&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;iː&quot;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;]  vs  &lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;&lt;span class=&quot;hljs-selector-attr&quot;&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;ɛ&quot;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); font-family: Helvetica; white-space: normal;&quot;&gt;]&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&lt;p data-start=&quot;3492&quot; data-end=&quot;3539&quot;&gt;&lt;font style=&quot;font-size: 15px;&quot;&gt;✅ Phoneme space preserves &lt;strong style=&quot;&quot; data-start=&quot;3518&quot; data-end=&quot;3539&quot;&gt;acoustic contrast&lt;/strong&gt;&lt;/font&gt;&lt;/p&gt;" link="&lt;p data-start=&quot;3221&quot; data-end=&quot;3245&quot;&gt;Imagine these two words:&lt;/p&gt;&#xa;&lt;ul data-start=&quot;3247&quot; data-end=&quot;3302&quot;&gt;&#xa;&lt;li data-start=&quot;3247&quot; data-end=&quot;3276&quot;&gt;&#xa;&lt;p data-start=&quot;3249&quot; data-end=&quot;3276&quot;&gt;“read” (present) = /r iː d/&lt;/p&gt;&#xa;&lt;/li&gt;&#xa;&lt;li data-start=&quot;3277&quot; data-end=&quot;3302&quot;&gt;&#xa;&lt;p data-start=&quot;3279&quot; data-end=&quot;3302&quot;&gt;“read” (past) = /r ɛ d/&lt;/p&gt;&#xa;&lt;/li&gt;&#xa;&lt;/ul&gt;&#xa;&lt;p data-start=&quot;3304&quot; data-end=&quot;3349&quot;&gt;BPE might tokenize both as the same subwords:&lt;/p&gt;&#xa;&lt;pre class=&quot;overflow-visible!&quot; data-start=&quot;3350&quot; data-end=&quot;3370&quot;&gt;&lt;div class=&quot;contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary&quot;&gt;&lt;div class=&quot;flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary select-none rounded-t-2xl&quot;&gt;css&lt;/div&gt;&lt;div class=&quot;sticky top-9&quot;&gt;&lt;div class=&quot;absolute end-0 bottom-0 flex h-9 items-center pe-2&quot;&gt;&lt;div class=&quot;bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs&quot;&gt;&lt;button class=&quot;flex gap-1 items-center select-none py-1&quot; aria-label=&quot;Copy&quot;&gt;&lt;svg width=&quot;20&quot; height=&quot;20&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;icon-xs&quot;&gt;&lt;path d=&quot;M12.668 10.667C12.668 9.95614 12.668 9.46258 12.6367 9.0791C12.6137 8.79732 12.5758 8.60761 12.5244 8.46387L12.4688 8.33399C12.3148 8.03193 12.0803 7.77885 11.793 7.60254L11.666 7.53125C11.508 7.45087 11.2963 7.39395 10.9209 7.36328C10.5374 7.33197 10.0439 7.33203 9.33301 7.33203H6.5C5.78896 7.33203 5.29563 7.33195 4.91211 7.36328C4.63016 7.38632 4.44065 7.42413 4.29688 7.47559L4.16699 7.53125C3.86488 7.68518 3.61186 7.9196 3.43555 8.20703L3.36524 8.33399C3.28478 8.49198 3.22795 8.70352 3.19727 9.0791C3.16595 9.46259 3.16504 9.95611 3.16504 10.667V13.5C3.16504 14.211 3.16593 14.7044 3.19727 15.0879C3.22797 15.4636 3.28473 15.675 3.36524 15.833L3.43555 15.959C3.61186 16.2466 3.86474 16.4807 4.16699 16.6348L4.29688 16.6914C4.44063 16.7428 4.63025 16.7797 4.91211 16.8027C5.29563 16.8341 5.78896 16.835 6.5 16.835H9.33301C10.0439 16.835 10.5374 16.8341 10.9209 16.8027C11.2965 16.772 11.508 16.7152 11.666 16.6348L11.793 16.5645C12.0804 16.3881 12.3148 16.1351 12.4688 15.833L12.5244 15.7031C12.5759 15.5594 12.6137 15.3698 12.6367 15.0879C12.6681 14.7044 12.668 14.211 12.668 13.5V10.667ZM13.998 12.665C14.4528 12.6634 14.8011 12.6602 15.0879 12.6367C15.4635 12.606 15.675 12.5492 15.833 12.4688L15.959 12.3975C16.2466 12.2211 16.4808 11.9682 16.6348 11.666L16.6914 11.5361C16.7428 11.3924 16.7797 11.2026 16.8027 10.9209C16.8341 10.5374 16.835 10.0439 16.835 9.33301V6.5C16.835 5.78896 16.8341 5.29563 16.8027 4.91211C16.7797 4.63025 16.7428 4.44063 16.6914 4.29688L16.6348 4.16699C16.4807 3.86474 16.2466 3.61186 15.959 3.43555L15.833 3.36524C15.675 3.28473 15.4636 3.22797 15.0879 3.19727C14.7044 3.16593 14.211 3.16504 13.5 3.16504H10.667C9.9561 3.16504 9.46259 3.16595 9.0791 3.19727C8.79739 3.22028 8.6076 3.2572 8.46387 3.30859L8.33399 3.36524C8.03176 3.51923 7.77886 3.75343 7.60254 4.04102L7.53125 4.16699C7.4508 4.32498 7.39397 4.53655 7.36328 4.91211C7.33985 5.19893 7.33562 5.54719 7.33399 6.00195H9.33301C10.022 6.00195 10.5791 6.00131 11.0293 6.03809C11.4873 6.07551 11.8937 6.15471 12.2705 6.34668L12.4883 6.46875C12.984 6.7728 13.3878 7.20854 13.6533 7.72949L13.7197 7.87207C13.8642 8.20859 13.9292 8.56974 13.9619 8.9707C13.9987 9.42092 13.998 9.97799 13.998 10.667V12.665ZM18.165 9.33301C18.165 10.022 18.1657 10.5791 18.1289 11.0293C18.0961 11.4302 18.0311 11.7914 17.8867 12.1279L17.8203 12.2705C17.5549 12.7914 17.1509 13.2272 16.6553 13.5313L16.4365 13.6533C16.0599 13.8452 15.6541 13.9245 15.1963 13.9619C14.8593 13.9895 14.4624 13.9935 13.9951 13.9951C13.9935 14.4624 13.9895 14.8593 13.9619 15.1963C13.9292 15.597 13.864 15.9576 13.7197 16.2939L13.6533 16.4365C13.3878 16.9576 12.9841 17.3941 12.4883 17.6982L12.2705 17.8203C11.8937 18.0123 11.4873 18.0915 11.0293 18.1289C10.5791 18.1657 10.022 18.165 9.33301 18.165H6.5C5.81091 18.165 5.25395 18.1657 4.80371 18.1289C4.40306 18.0962 4.04235 18.031 3.70606 17.8867L3.56348 17.8203C3.04244 17.5548 2.60585 17.151 2.30176 16.6553L2.17969 16.4365C1.98788 16.0599 1.90851 15.6541 1.87109 15.1963C1.83431 14.746 1.83496 14.1891 1.83496 13.5V10.667C1.83496 9.978 1.83432 9.42091 1.87109 8.9707C1.90851 8.5127 1.98772 8.10625 2.17969 7.72949L2.30176 7.51172C2.60586 7.0159 3.04236 6.6122 3.56348 6.34668L3.70606 6.28027C4.04237 6.136 4.40303 6.07083 4.80371 6.03809C5.14051 6.01057 5.53708 6.00551 6.00391 6.00391C6.00551 5.53708 6.01057 5.14051 6.03809 4.80371C6.0755 4.34588 6.15483 3.94012 6.34668 3.56348L6.46875 3.34473C6.77282 2.84912 7.20856 2.44514 7.72949 2.17969L7.87207 2.11328C8.20855 1.96886 8.56979 1.90385 8.9707 1.87109C9.42091 1.83432 9.978 1.83496 10.667 1.83496H13.5C14.1891 1.83496 14.746 1.83431 15.1963 1.87109C15.6541 1.90851 16.0599 1.98788 16.4365 2.17969L16.6553 2.30176C17.151 2.60585 17.5548 3.04244 17.8203 3.56348L17.8867 3.70606C18.031 4.04235 18.0962 4.40306 18.1289 4.80371C18.1657 5.25395 18.165 5.81091 18.165 6.5V9.33301Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;Copy&lt;/button&gt;&lt;span class=&quot;&quot; data-state=&quot;closed&quot;&gt;&lt;button class=&quot;flex items-center gap-1 py-1 select-none&quot;&gt;&lt;svg width=&quot;20&quot; height=&quot;20&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;icon-xs&quot;&gt;&lt;path d=&quot;M12.0303 4.11328C13.4406 2.70317 15.7275 2.70305 17.1377 4.11328C18.5474 5.52355 18.5476 7.81057 17.1377 9.2207L10.8457 15.5117C10.522 15.8354 10.2868 16.0723 10.0547 16.2627L9.82031 16.4395C9.61539 16.5794 9.39783 16.7003 9.1709 16.7998L8.94141 16.8916C8.75976 16.9582 8.57206 17.0072 8.35547 17.0518L7.59082 17.1865L5.19727 17.5859C5.05455 17.6097 4.90286 17.6358 4.77441 17.6455C4.67576 17.653 4.54196 17.6555 4.39648 17.6201L4.24707 17.5703C4.02415 17.4746 3.84119 17.3068 3.72559 17.0957L3.67969 17.0029C3.59322 16.8013 3.59553 16.6073 3.60547 16.4756C3.61519 16.3473 3.6403 16.1963 3.66406 16.0537L4.06348 13.6602C4.1638 13.0582 4.22517 12.6732 4.3584 12.3096L4.45117 12.0791C4.55073 11.8521 4.67152 11.6346 4.81152 11.4297L4.9873 11.1953C5.17772 10.9632 5.4146 10.728 5.73828 10.4043L12.0303 4.11328ZM6.67871 11.3447C6.32926 11.6942 6.14542 11.8803 6.01953 12.0332L5.90918 12.1797C5.81574 12.3165 5.73539 12.4618 5.66895 12.6133L5.60742 12.7666C5.52668 12.9869 5.48332 13.229 5.375 13.8789L4.97656 16.2725L4.97559 16.2744H4.97852L7.37207 15.875L8.08887 15.749C8.25765 15.7147 8.37336 15.6839 8.4834 15.6436L8.63672 15.5811C8.78817 15.5146 8.93356 15.4342 9.07031 15.3408L9.2168 15.2305C9.36965 15.1046 9.55583 14.9207 9.90527 14.5713L14.8926 9.58301L11.666 6.35742L6.67871 11.3447ZM16.1963 5.05371C15.3054 4.16304 13.8616 4.16305 12.9707 5.05371L12.6074 5.41602L15.833 8.64258L16.1963 8.2793C17.0869 7.38845 17.0869 5.94456 16.1963 5.05371Z&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M4.58301 1.7832C4.72589 1.7832 4.84877 1.88437 4.87695 2.02441C4.99384 2.60873 5.22432 3.11642 5.58398 3.50391C5.94115 3.88854 6.44253 4.172 7.13281 4.28711C7.27713 4.3114 7.38267 4.43665 7.38281 4.58301C7.38281 4.7295 7.27723 4.8546 7.13281 4.87891C6.44249 4.99401 5.94116 5.27746 5.58398 5.66211C5.26908 6.00126 5.05404 6.43267 4.92676 6.92676L4.87695 7.1416C4.84891 7.28183 4.72601 7.38281 4.58301 7.38281C4.44013 7.38267 4.31709 7.28173 4.28906 7.1416C4.17212 6.55728 3.94179 6.04956 3.58203 5.66211C3.22483 5.27757 2.72347 4.99395 2.0332 4.87891C1.88897 4.85446 1.7832 4.72938 1.7832 4.58301C1.78335 4.43673 1.88902 4.3115 2.0332 4.28711C2.72366 4.17203 3.22481 3.88861 3.58203 3.50391C3.94186 3.11638 4.17214 2.60888 4.28906 2.02441L4.30371 1.97363C4.34801 1.86052 4.45804 1.78333 4.58301 1.7832Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;Edit&lt;/button&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;overflow-y-auto p-4&quot; dir=&quot;ltr&quot;&gt;&lt;code class=&quot;whitespace-pre!&quot;&gt;&lt;span&gt;&lt;span&gt;&lt;span class=&quot;hljs-selector-attr&quot;&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;re&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;ad&quot;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;]&#xa;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&#xa;&lt;p data-start=&quot;3371&quot; data-end=&quot;3413&quot;&gt;→ &lt;strong data-start=&quot;3373&quot; data-end=&quot;3413&quot;&gt;Same embedding, but different sounds&lt;/strong&gt;&lt;/p&gt;&#xa;&lt;p data-start=&quot;3415&quot; data-end=&quot;3444&quot;&gt;Phonemes would separate them:&lt;/p&gt;&#xa;&lt;pre class=&quot;overflow-visible!&quot; data-start=&quot;3445&quot; data-end=&quot;3490&quot;&gt;&lt;div class=&quot;contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary&quot;&gt;&lt;div class=&quot;flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary select-none rounded-t-2xl&quot;&gt;css&lt;/div&gt;&lt;div class=&quot;sticky top-9&quot;&gt;&lt;div class=&quot;absolute end-0 bottom-0 flex h-9 items-center pe-2&quot;&gt;&lt;div class=&quot;bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs&quot;&gt;&lt;button class=&quot;flex gap-1 items-center select-none py-1&quot; aria-label=&quot;Copy&quot;&gt;&lt;svg width=&quot;20&quot; height=&quot;20&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;icon-xs&quot;&gt;&lt;path d=&quot;M12.668 10.667C12.668 9.95614 12.668 9.46258 12.6367 9.0791C12.6137 8.79732 12.5758 8.60761 12.5244 8.46387L12.4688 8.33399C12.3148 8.03193 12.0803 7.77885 11.793 7.60254L11.666 7.53125C11.508 7.45087 11.2963 7.39395 10.9209 7.36328C10.5374 7.33197 10.0439 7.33203 9.33301 7.33203H6.5C5.78896 7.33203 5.29563 7.33195 4.91211 7.36328C4.63016 7.38632 4.44065 7.42413 4.29688 7.47559L4.16699 7.53125C3.86488 7.68518 3.61186 7.9196 3.43555 8.20703L3.36524 8.33399C3.28478 8.49198 3.22795 8.70352 3.19727 9.0791C3.16595 9.46259 3.16504 9.95611 3.16504 10.667V13.5C3.16504 14.211 3.16593 14.7044 3.19727 15.0879C3.22797 15.4636 3.28473 15.675 3.36524 15.833L3.43555 15.959C3.61186 16.2466 3.86474 16.4807 4.16699 16.6348L4.29688 16.6914C4.44063 16.7428 4.63025 16.7797 4.91211 16.8027C5.29563 16.8341 5.78896 16.835 6.5 16.835H9.33301C10.0439 16.835 10.5374 16.8341 10.9209 16.8027C11.2965 16.772 11.508 16.7152 11.666 16.6348L11.793 16.5645C12.0804 16.3881 12.3148 16.1351 12.4688 15.833L12.5244 15.7031C12.5759 15.5594 12.6137 15.3698 12.6367 15.0879C12.6681 14.7044 12.668 14.211 12.668 13.5V10.667ZM13.998 12.665C14.4528 12.6634 14.8011 12.6602 15.0879 12.6367C15.4635 12.606 15.675 12.5492 15.833 12.4688L15.959 12.3975C16.2466 12.2211 16.4808 11.9682 16.6348 11.666L16.6914 11.5361C16.7428 11.3924 16.7797 11.2026 16.8027 10.9209C16.8341 10.5374 16.835 10.0439 16.835 9.33301V6.5C16.835 5.78896 16.8341 5.29563 16.8027 4.91211C16.7797 4.63025 16.7428 4.44063 16.6914 4.29688L16.6348 4.16699C16.4807 3.86474 16.2466 3.61186 15.959 3.43555L15.833 3.36524C15.675 3.28473 15.4636 3.22797 15.0879 3.19727C14.7044 3.16593 14.211 3.16504 13.5 3.16504H10.667C9.9561 3.16504 9.46259 3.16595 9.0791 3.19727C8.79739 3.22028 8.6076 3.2572 8.46387 3.30859L8.33399 3.36524C8.03176 3.51923 7.77886 3.75343 7.60254 4.04102L7.53125 4.16699C7.4508 4.32498 7.39397 4.53655 7.36328 4.91211C7.33985 5.19893 7.33562 5.54719 7.33399 6.00195H9.33301C10.022 6.00195 10.5791 6.00131 11.0293 6.03809C11.4873 6.07551 11.8937 6.15471 12.2705 6.34668L12.4883 6.46875C12.984 6.7728 13.3878 7.20854 13.6533 7.72949L13.7197 7.87207C13.8642 8.20859 13.9292 8.56974 13.9619 8.9707C13.9987 9.42092 13.998 9.97799 13.998 10.667V12.665ZM18.165 9.33301C18.165 10.022 18.1657 10.5791 18.1289 11.0293C18.0961 11.4302 18.0311 11.7914 17.8867 12.1279L17.8203 12.2705C17.5549 12.7914 17.1509 13.2272 16.6553 13.5313L16.4365 13.6533C16.0599 13.8452 15.6541 13.9245 15.1963 13.9619C14.8593 13.9895 14.4624 13.9935 13.9951 13.9951C13.9935 14.4624 13.9895 14.8593 13.9619 15.1963C13.9292 15.597 13.864 15.9576 13.7197 16.2939L13.6533 16.4365C13.3878 16.9576 12.9841 17.3941 12.4883 17.6982L12.2705 17.8203C11.8937 18.0123 11.4873 18.0915 11.0293 18.1289C10.5791 18.1657 10.022 18.165 9.33301 18.165H6.5C5.81091 18.165 5.25395 18.1657 4.80371 18.1289C4.40306 18.0962 4.04235 18.031 3.70606 17.8867L3.56348 17.8203C3.04244 17.5548 2.60585 17.151 2.30176 16.6553L2.17969 16.4365C1.98788 16.0599 1.90851 15.6541 1.87109 15.1963C1.83431 14.746 1.83496 14.1891 1.83496 13.5V10.667C1.83496 9.978 1.83432 9.42091 1.87109 8.9707C1.90851 8.5127 1.98772 8.10625 2.17969 7.72949L2.30176 7.51172C2.60586 7.0159 3.04236 6.6122 3.56348 6.34668L3.70606 6.28027C4.04237 6.136 4.40303 6.07083 4.80371 6.03809C5.14051 6.01057 5.53708 6.00551 6.00391 6.00391C6.00551 5.53708 6.01057 5.14051 6.03809 4.80371C6.0755 4.34588 6.15483 3.94012 6.34668 3.56348L6.46875 3.34473C6.77282 2.84912 7.20856 2.44514 7.72949 2.17969L7.87207 2.11328C8.20855 1.96886 8.56979 1.90385 8.9707 1.87109C9.42091 1.83432 9.978 1.83496 10.667 1.83496H13.5C14.1891 1.83496 14.746 1.83431 15.1963 1.87109C15.6541 1.90851 16.0599 1.98788 16.4365 2.17969L16.6553 2.30176C17.151 2.60585 17.5548 3.04244 17.8203 3.56348L17.8867 3.70606C18.031 4.04235 18.0962 4.40306 18.1289 4.80371C18.1657 5.25395 18.165 5.81091 18.165 6.5V9.33301Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;Copy&lt;/button&gt;&lt;span class=&quot;&quot; data-state=&quot;closed&quot;&gt;&lt;button class=&quot;flex items-center gap-1 py-1 select-none&quot;&gt;&lt;svg width=&quot;20&quot; height=&quot;20&quot; viewBox=&quot;0 0 20 20&quot; fill=&quot;currentColor&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; class=&quot;icon-xs&quot;&gt;&lt;path d=&quot;M12.0303 4.11328C13.4406 2.70317 15.7275 2.70305 17.1377 4.11328C18.5474 5.52355 18.5476 7.81057 17.1377 9.2207L10.8457 15.5117C10.522 15.8354 10.2868 16.0723 10.0547 16.2627L9.82031 16.4395C9.61539 16.5794 9.39783 16.7003 9.1709 16.7998L8.94141 16.8916C8.75976 16.9582 8.57206 17.0072 8.35547 17.0518L7.59082 17.1865L5.19727 17.5859C5.05455 17.6097 4.90286 17.6358 4.77441 17.6455C4.67576 17.653 4.54196 17.6555 4.39648 17.6201L4.24707 17.5703C4.02415 17.4746 3.84119 17.3068 3.72559 17.0957L3.67969 17.0029C3.59322 16.8013 3.59553 16.6073 3.60547 16.4756C3.61519 16.3473 3.6403 16.1963 3.66406 16.0537L4.06348 13.6602C4.1638 13.0582 4.22517 12.6732 4.3584 12.3096L4.45117 12.0791C4.55073 11.8521 4.67152 11.6346 4.81152 11.4297L4.9873 11.1953C5.17772 10.9632 5.4146 10.728 5.73828 10.4043L12.0303 4.11328ZM6.67871 11.3447C6.32926 11.6942 6.14542 11.8803 6.01953 12.0332L5.90918 12.1797C5.81574 12.3165 5.73539 12.4618 5.66895 12.6133L5.60742 12.7666C5.52668 12.9869 5.48332 13.229 5.375 13.8789L4.97656 16.2725L4.97559 16.2744H4.97852L7.37207 15.875L8.08887 15.749C8.25765 15.7147 8.37336 15.6839 8.4834 15.6436L8.63672 15.5811C8.78817 15.5146 8.93356 15.4342 9.07031 15.3408L9.2168 15.2305C9.36965 15.1046 9.55583 14.9207 9.90527 14.5713L14.8926 9.58301L11.666 6.35742L6.67871 11.3447ZM16.1963 5.05371C15.3054 4.16304 13.8616 4.16305 12.9707 5.05371L12.6074 5.41602L15.833 8.64258L16.1963 8.2793C17.0869 7.38845 17.0869 5.94456 16.1963 5.05371Z&quot;&gt;&lt;/path&gt;&lt;path d=&quot;M4.58301 1.7832C4.72589 1.7832 4.84877 1.88437 4.87695 2.02441C4.99384 2.60873 5.22432 3.11642 5.58398 3.50391C5.94115 3.88854 6.44253 4.172 7.13281 4.28711C7.27713 4.3114 7.38267 4.43665 7.38281 4.58301C7.38281 4.7295 7.27723 4.8546 7.13281 4.87891C6.44249 4.99401 5.94116 5.27746 5.58398 5.66211C5.26908 6.00126 5.05404 6.43267 4.92676 6.92676L4.87695 7.1416C4.84891 7.28183 4.72601 7.38281 4.58301 7.38281C4.44013 7.38267 4.31709 7.28173 4.28906 7.1416C4.17212 6.55728 3.94179 6.04956 3.58203 5.66211C3.22483 5.27757 2.72347 4.99395 2.0332 4.87891C1.88897 4.85446 1.7832 4.72938 1.7832 4.58301C1.78335 4.43673 1.88902 4.3115 2.0332 4.28711C2.72366 4.17203 3.22481 3.88861 3.58203 3.50391C3.94186 3.11638 4.17214 2.60888 4.28906 2.02441L4.30371 1.97363C4.34801 1.86052 4.45804 1.78333 4.58301 1.7832Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;Edit&lt;/button&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;overflow-y-auto p-4&quot; dir=&quot;ltr&quot;&gt;&lt;code class=&quot;whitespace-pre!&quot;&gt;&lt;span&gt;&lt;span&gt;&lt;span class=&quot;hljs-selector-attr&quot;&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;iː&quot;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;]  vs  &lt;/span&gt;&lt;span&gt;&lt;span class=&quot;hljs-selector-attr&quot;&gt;[&lt;span class=&quot;hljs-string&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;ɛ&quot;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;]&#xa;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/div&gt;&lt;/div&gt;&lt;/pre&gt;&#xa;&lt;p data-start=&quot;3492&quot; data-end=&quot;3539&quot;&gt;✅ Phoneme space preserves &lt;strong data-start=&quot;3518&quot; data-end=&quot;3539&quot;&gt;acoustic contrast&lt;/strong&gt;&lt;/p&gt;" id="nW7XktpqRqi-2gm5SUBW-86">
          <mxCell style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="260" y="1710" width="310" height="250" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-87" value="&lt;font style=&quot;font-size: 19px;&quot;&gt;&lt;b&gt;Challenge :&amp;nbsp;&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-540" y="2166.5" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-88" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Multiligual TTS : Different language phonemes may differ:&amp;nbsp;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Strategy to solve this could be :&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;1. Use a G2P tool per language to convert text to phonemes&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;2. Append Language ID token&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;3. Create a shared phoneme vocabulary with overlaps (like common vowels and consonants)&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;❌ Cons :&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;Need G2P tool per language : espeak-ng support 100+ languages&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;May need to normalize phoneme sets (IPA or ARPABET style)&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-530" y="2206.5" width="600" height="150" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-89" value="&lt;i&gt;This is challenging cause both text and audio are initially from different distribution ,&amp;nbsp;&lt;/i&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;i&gt;represent different modalitites, have different time scales,&amp;nbsp;&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;&lt;i&gt;&lt;br&gt;&lt;/i&gt;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Few options:&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;1. apply RoPE to both modalities, then stack or concatinate them , because RoPE&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;encodes their time order continuosly , But still assume same scale , which may be wrong&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;2. Cross Attension :&amp;nbsp;&lt;/div&gt;&lt;div style=&quot;text-align: left;&quot;&gt;Intuition: Let audio token query the relevant parts of the text - not merge them&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="155" y="605" width="490" height="130" as="geometry" />
        </mxCell>
        <mxCell id="nW7XktpqRqi-2gm5SUBW-91" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;OR&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-380" y="615" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-1" value="Ground truth RVQ vectors" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-725" y="425" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-2" value="Will learn text - audio representation" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-520" y="255" width="220" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-5" value="Language ID (dim = 16 or 64)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-325" y="-20" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wmjjGflO25J7VR-AUJGW-6" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-235" y="110" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-6" value="Learned Language Embedding matrix" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-295" y="15" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wmjjGflO25J7VR-AUJGW-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-225" y="230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-7" value="projection layer" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-285" y="110" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-9" value="&lt;i&gt;language embedding can be low-dimensional (e.g., 16, 32).&lt;/i&gt;&lt;div&gt;&lt;i&gt;Because language is categorical metadata, not as rich as a token&lt;/i&gt;&lt;/div&gt;&lt;div&gt;&lt;i&gt;Helps avoid overfitting or memorizing per language quirks&lt;/i&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-325" y="-90" width="370" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-13" value="Text to Phonemes" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-670" y="255" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-44" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wmjjGflO25J7VR-AUJGW-14" target="wmjjGflO25J7VR-AUJGW-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-14" value="CROSS ATTENTION" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="87.5" y="410" width="145" height="95" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wmjjGflO25J7VR-AUJGW-16" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-85" y="230" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-16" value="Position encoding , it can RoPE or other variaents" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-145" y="15" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wmjjGflO25J7VR-AUJGW-17" target="wmjjGflO25J7VR-AUJGW-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-52" value="&lt;font style=&quot;font-size: 17px;&quot;&gt;K , V&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="wmjjGflO25J7VR-AUJGW-36" vertex="1" connectable="0">
          <mxGeometry x="0.2839" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-17" value="Encoder -&amp;gt; Self attention, FNN layers" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="100" y="195" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-18" value="&lt;i&gt;Raw token embeddings (even after RoPE) are &lt;span style=&quot;&quot; data-start=&quot;448&quot; data-end=&quot;473&quot;&gt;not expressive enough&lt;/span&gt;&lt;/i&gt;&lt;div&gt;&lt;span data-start=&quot;448&quot; data-end=&quot;473&quot;&gt;&lt;i&gt;We want to &lt;span style=&quot;&quot; data-end=&quot;571&quot; data-start=&quot;488&quot;&gt;transform the phoneme/token sequence into a richer context-aware representation&lt;/span&gt;.&lt;/i&gt;&lt;/span&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-335" y="285" width="410" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-34" value="&lt;b&gt;&lt;font style=&quot;font-size: 34px;&quot;&gt;Training&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-920" y="320" width="160" height="50" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-58" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="wmjjGflO25J7VR-AUJGW-35" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-760" y="529.9999999999998" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-35" value="(Right shifted)" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-730" y="488" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="wmjjGflO25J7VR-AUJGW-37" target="nW7XktpqRqi-2gm5SUBW-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-37" value="CROSS ATTENTION" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="295" y="410" width="145" height="95" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" target="wmjjGflO25J7VR-AUJGW-39" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="370" y="90" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-38" value="Audio Prompt from RVQ as vectors" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="265" y="60" width="210" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-39" value="Projection Layer" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="310" y="172" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="wmjjGflO25J7VR-AUJGW-39" target="wmjjGflO25J7VR-AUJGW-37" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-53" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;K , V&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="wmjjGflO25J7VR-AUJGW-42" vertex="1" connectable="0">
          <mxGeometry x="0.3518" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-43" value="No encoder needed cause ,&amp;nbsp;&lt;div&gt;these vectors are already rich info&amp;nbsp;&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="355" y="270" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="wmjjGflO25J7VR-AUJGW-46" target="wmjjGflO25J7VR-AUJGW-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-51" value="&lt;font style=&quot;font-size: 22px;&quot;&gt;Q&lt;/font&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="wmjjGflO25J7VR-AUJGW-49" vertex="1" connectable="0">
          <mxGeometry x="0.4185" y="-3" relative="1" as="geometry">
            <mxPoint x="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-46" value="Masked Self attention" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-165" y="425" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-47" value="&lt;i&gt;Causal&lt;/i&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-140" y="498" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-54" value="Which part of the text (phonemes) helps me sound correct here" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-35" y="505" width="360" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-55" value="Audio aligned features" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="190" y="380" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-56" value="Start Token = &amp;lt;BOS&amp;gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-845" y="535" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-59" value="Can be learned embedding OR Projected language embedding" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-930" y="558" width="360" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-60" value="For AR Training" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-165" y="518" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-61" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;All Tokens of Quantizer 1 predicted at once : [B , T] , batch , tokens of C:,1 for AR case&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="845" y="202" width="640" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-63" value="&lt;font style=&quot;font-size: 15px;&quot;&gt;&lt;b&gt;C~ :. 1&lt;/b&gt;&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="360" y="120" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-64" value="[B, T, D]" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-835" y="588" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-65" value="&lt;b&gt;&lt;font style=&quot;font-size: 17px;&quot;&gt;AR case&lt;/font&gt;&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-930" y="535" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-66" value="&lt;b&gt;&lt;font style=&quot;font-size: 16px;&quot;&gt;NON AR &lt;/font&gt;&lt;/b&gt;Prompt:&amp;nbsp; Full C:,1, C:,2 upto C:,(j-1) from ground truth&amp;nbsp;&amp;nbsp;&lt;div&gt;(Dynamic cross-attention , can&#39;t dynamically change the architecture, but can be done&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); background-color: transparent;&quot;&gt;using Dynamic memory concatenation)&lt;/span&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;Text tokens&lt;/div&gt;&lt;div&gt;Prompt Audio (Full RVQ vectors)&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-920" y="625" width="480" height="90" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-68" value="NAR Decoder input : C:,j form ground truth, right shifter&amp;nbsp;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="-930" y="699" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-69" value="&lt;font style=&quot;font-size: 16px;&quot;&gt;This is applied every layer of the decoder&lt;/font&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="130" y="535" width="320" height="30" as="geometry" />
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-70" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;exitX=1;exitY=0.75;exitDx=0;exitDy=0;" parent="1" source="wmjjGflO25J7VR-AUJGW-39" target="nW7XktpqRqi-2gm5SUBW-4" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="490" y="232" as="sourcePoint" />
            <mxPoint x="540" y="182" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="wmjjGflO25J7VR-AUJGW-71" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0;exitY=0;exitDx=0;exitDy=0;" parent="1" source="nW7XktpqRqi-2gm5SUBW-4" target="wmjjGflO25J7VR-AUJGW-17" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="440" y="410" as="sourcePoint" />
            <mxPoint x="490" y="360" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
